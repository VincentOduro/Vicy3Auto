# Corrected File: mod/vicy3auto/common/journal_entries/agriculture_building.txt

journal = {
    id = vicy3auto.dynamic_agri
    group = vicy3auto_automation
    title = vicy3auto.dynamic_agri
    desc  = vicy3auto.dynamic_agri_reason
    fire_only_once = no

    on_weekly_pulse = {
        trigger = {
            is_player = yes
            has_country_modifier = vicy3auto_agri_active
        }
        immediate = {
            any_country = {
                is_player = yes
                every_owned_state = {
                    limit = { arable_land > 0 }

                    choose = {
                        # Wheat Farms
                        factor = {
                            limit = {
                                any_province = {
                                    has_building_slot = wheat_farms
                                    base_farming_output_percent > 130
                                }
                            }
                            owner = {
                                add_to_construction_queue = {
                                    building = wheat_farms
                                    level    = arable_land
                                    target   = scope:state
                                }
                            }
                        }

                        # Rye Farms
                        factor = {
                            limit = {
                                any_province = {
                                    has_building_slot = rye_farms
                                    base_farming_output_percent > 125
                                }
                            }
                            owner = {
                                add_to_construction_queue = {
                                    building = rye_farms
                                    level    = arable_land
                                    target   = scope:state
                                }
                            }
                        }

                        # Rice Farms
                        factor = {
                            limit = {
                                any_province = {
                                    has_building_slot = rice_farms
                                    base_farming_output_percent > 115
                                }
                            }
                            owner = {
                                add_to_construction_queue = {
                                    building = rice_farms
                                    level    = arable_land
                                    target   = scope:state
                                }
                            }
                        }

                        # Maize Farms
                        factor = {
                            limit = {
                                any_province = {
                                    has_building_slot = maize_farms
                                    base_farming_output_percent > 110
                                }
                            }
                            owner = {
                                add_to_construction_queue = {
                                    building = maize_farms
                                    level    = arable_land
                                    target   = scope:state
                                }
                            }
                        }

                        # Millet Farms
                        factor = {
                            limit = {
                                any_province = {
                                    has_building_slot = millet_farms
                                    base_farming_output_percent > 105
                                }
                            }
                            owner = {
                                add_to_construction_queue = {
                                    building = millet_farms
                                    level    = arable_land
                                    target   = scope:state
                                }
                            }
                        }

                        # Vineyard
                        factor = {
                            limit = {
                                any_province = {
                                    has_building_slot = vineyard
                                    base_farming_output_percent > 100
                                }
                            }
                            owner = {
                                add_to_construction_queue = {
                                    building = vineyard
                                    level    = arable_land
                                    target   = scope:state
                                }
                            }
                        }

                        else = { }
                    }
                }
            }
        }
    }
}
